pico-8 cartridge // http://www.pico-8.com
version 39
__lua__
-- init, draw, update, and input
  function _init() 
    poke(0x5F2D, 1)
    cursor = {
      x = 10,
      y = 10,
      w = 1,
      h = 1,
      clicking = false,
    }
  slime1 = {
  x = 30,
  y = 30,
  speed = 0.1,
  }
  slimes = {}
  add_slime()
  add_slime()
  add_slime()    
  poops = {}
    poopData = {
      id = 68,
      w = 8,
      h = 8
      }
    poopCount = 0
  plantPoop(70, 90)

    gold = 0
  end

  function _draw()
    cls()
    map()
    drawSlime()
    drawPoop()
    
    -- rectfill(0,0,128,128,10)
    rectfill(98, 0, 127, 63, 6)
    rectfill(105, 9, 120, 10, 5)
    print("gold", 105, 3, 0)
    print(gold, 105, 12, 0)
   
    print(cursor.clicking, 0, 115, 8)
    spr(70, cursor.x, cursor.y)
  pal({[1]=3,[12]=11})
  spr( 069, slime1.x,slime1.y ) 
  pal()
  
  for slime in all(slimes) do
    spr( 069, slime.x,slime.y ) 
  end
end

function move_slimes()
  for slime in all(slimes) do
      slime.x = slime.x + flr(rnd(3) - 1) * slime.speed
      slime.y = slime.y + flr(rnd(3) - 1) * slime.speed
  end
end

function add_slime()
  newslime = {x = rnd(50)+30,y = rnd(50)+30,speed = 0.1,}
  add(slimes, newslime)
  local slime = slimes[count(slimes)]
  end

-- function _update()
--   -- move the sprite
--   slime1.x = slime1.x + flr(rnd(3) - 1) * slime1.speed
--   slime1.y = slime1.y + flr(rnd(3) - 1) * slime1.speed
-- end

  function _update60()
    input() 
    updatePoop()
  move_slimes()
end




  function input()
      cursor.x = stat(32) - 1
      cursor.y = stat(33) - 1
      cursor.clicking = stat(34) == 1
  end
-->8
-- poop code
  function drawPoop()
  for i=1, #poops do
    if poops[i].valid then 
      spr(poops[i].frame, poops[i].x, poops[i].y)
    end
  end
  end

  function plantPoop(x, y)
    local seed = {
      x = x,
      y = x,
      frame = poopData.id,
      w = poopData.w,
      h = poopData.h,
      valid = true,
    }
    poopCount += 1
    poops[poopCount] = seed
  end

  function updatePoop()
  for i=1, #poops do
    if collision_aabb(cursor, poops[i]) and poops[i].valid == true and cursor.clicking then
      gold += 1
      poops[i].valid = false
    end
  end
  end

-->8
-- slime code
  function drawSlime()
  for i=1, #slimes do
    if slimes[i].valid then 
      spr(slimes[i].frame, slimes[i].x, slimes[i].y)
    end
  end
  end

  function plantSlime(x, y)
    local seed = {
      x = x,
      y = x,
      frame = slimeData.id,
      w = slimeData.w,
      h = slimeData.h,
      valid = true,
    }
    slimeCount += 1
    slimes[slimeCount] = seed
  end

  function updateSlime()
  for i=1, #slimes do
    if collision_aabb(cursor, poops[i]) and slimes[i].valid == true and cursor.clicking then
      test += 1
      slimes[i].valid = false
    end
  end
  end
-->8
function collision_aabb(a, b)
	local a_right_b = a.x > b.x+b.w
	local a_left_b = a.x+a.w < b.x
	local a_above_b = a.y+a.h < b.y
	local a_below_b = a.y > b.y+b.h
	
	return not(a_right_b or 
		a_left_b or 
		a_above_b or 
		a_below_b)
end

__gfx__
777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555333333333333333344444444000440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
555555553333333333333b3349494444000440000011110000000000000000000000000000000000000000000000000000000000000000000000000000000000
666656663333333333b3b333444449440044440001cccc1000777700000000000000000000000000000000000000000000000000000000000000000000000000
66665666333333333b33333344444444444444441cc7c7c100777000000000000000000000000000000000000000000000000000000000000000000000000000
55555555333333333333b33344944494444444441cc0c0c100777700000000000000000000000000000000000000000000000000000000000000000000000000
6656666633333333333b33b344449444004444001cccccc100707700000000000000000000000000000000000000000000000000000000000000000000000000
665666663333333333b33b33944444440004400001cccc1000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555333333333333333344444494000440000011110000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
4141414141414141414141414747474744444141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4141414241414141414141414747474744414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4141414141424141414141414747474744414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4141424142414142414141414747474744414041414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4143434343434343434343414747474744414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4143434343434343434343414747474744414141404141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4143434343434343434343414747474744414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4143434343434343434343414747474744414140414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4143434343434343434343414747474744414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4143434343434343434343414747474744414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4143434343434343434343414747474744414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4143434343434343434343414747474744414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4143434343434343434343414747474744414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4141414141414141414141414747474744414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4141414141414141414141414747474744414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4141414141414141414141414747474744414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4444444444444444444444444444444444444141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
